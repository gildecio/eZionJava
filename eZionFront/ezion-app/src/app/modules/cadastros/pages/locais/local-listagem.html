<div class="locais-container">
  <!-- Diálogo de Confirmação -->
  <app-confirm-dialog
    [visible]="confirmDialogVisible"
    [title]="confirmDialogTitle"
    [message]="confirmDialogMessage"
    [confirmLabel]="confirmDialogLabel"
    (confirmed)="onConfirmDialogConfirmed()"
    (cancelled)="onConfirmDialogCancelled()"
  ></app-confirm-dialog>

  <div class="locais-header">
    <h1 class="locais-title">Locais</h1>
    <button class="btn-primary" (click)="onNovoLocal()">+ Novo Local</button>
  </div>

  <!-- Filtros -->
  <div class="filtros">
    <button class="btn-primary" (click)="carregarLocais()">Consultar</button>
  </div>

  <!-- Tabela de Locais -->
  <div class="locais-table-wrapper">
    <div *ngIf="carregando()" class="loading">
      <div class="spinner"></div>
      <p>Carregando locais...</p>
    </div>

    <table class="locais-table" *ngIf="!carregando() && locaisFiltrados().length">
      <thead>
        <tr>
          <th>ID</th>
          <th>Nome</th>
          <th>Status</th>
          <th>Data Criação</th>
          <th>Data Atualização</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let local of locaisFiltrados()">
          <td>{{ local.id }}</td>
          <td><strong>{{ local.nome }}</strong></td>
          <td>
            <span class="status-badge" [class.ativo]="local.ativo" [class.inativo]="!local.ativo">
              {{ local.ativo ? 'Ativo' : 'Inativo' }}
            </span>
          </td>
          <td>{{ local.dataCriacao | date:'dd/MM/yyyy HH:mm' }}</td>
          <td>{{ local.dataAtualizacao | date:'dd/MM/yyyy HH:mm' }}</td>
          <td class="acoes">
            <button
              pButton
              type="button"
              [rounded]="true"
              [text]="true"
              icon="pi pi-eye"
              pTooltip="Visualizar"
              tooltipPosition="top"
              (click)="onVisualizarLocal(local)"
              class="p-button-sm p-button-secondary"
            ></button>
            <button
              pButton
              type="button"
              [rounded]="true"
              [text]="true"
              icon="pi pi-pencil"
              pTooltip="Editar"
              tooltipPosition="top"
              (click)="onEditarLocal(local)"
              class="p-button-sm p-button-info"
            ></button>
            <button
              pButton
              type="button"
              [rounded]="true"
              [text]="true"
              icon="pi pi-trash"
              pTooltip="Excluir"
              tooltipPosition="top"
              (click)="deletarLocal(local.id!)"
              class="p-button-sm p-button-danger"
            ></button>
          </td>
        </tr>
      </tbody>
    </table>

    <div *ngIf="!carregando() && !locaisFiltrados().length" class="empty-state">
      <div class="empty-icon">
        <i class="pi pi-box"></i>
      </div>
      <h3>Nenhum local encontrado</h3>
      <p>Clique em "Consultar" para carregar os locais ou "Novo Local" para adicionar um.</p>
    </div>
  </div>
</div>