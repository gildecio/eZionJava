<div class="empresas-container">
  <!-- Diálogo de Confirmação -->
  <app-confirm-dialog
    [visible]="confirmDialogVisible"
    [title]="confirmDialogTitle"
    [message]="confirmDialogMessage"
    [confirmLabel]="confirmDialogLabel"
    (confirmed)="onConfirmDialogConfirmed()"
    (cancelled)="onConfirmDialogCancelled()"
  ></app-confirm-dialog>

  <div class="empresas-header">
    <h1 class="empresas-title">Empresas</h1>
    <button class="btn-primary" (click)="onNovaEmpresa()">+ Nova Empresa</button>
  </div>

  <!-- Filtros -->
  <div class="filtros">
    <button class="btn-primary" (click)="carregarEmpresas()">Consultar</button>
  </div>

  <!-- Tabela de Empresas -->
  <div class="empresas-table-wrapper">
    <div *ngIf="carregando()" class="loading">
      <div class="spinner"></div>
      <p>Carregando empresas...</p>
    </div>

    <table class="empresas-table" *ngIf="!carregando() && empresasFiltradas().length">
      <thead>
        <tr>
          <th>ID</th>
          <th>Razão Social</th>
          <th>Nome Fantasia</th>
          <th>CNPJ</th>
          <th>Email</th>
          <th>Status</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let empresa of empresasFiltradas()">
          <td>{{ empresa.id }}</td>
          <td><strong>{{ empresa.razaoSocial }}</strong></td>
          <td>{{ empresa.nomeFantasia }}</td>
          <td>{{ empresa.cnpj | cnpjMask }}</td>
          <td>{{ empresa.email || '-' }}</td>
          <td>
            <span class="status-badge" [class.ativa]="empresa.ativa" [class.inativa]="!empresa.ativa">
              {{ empresa.ativa ? 'Ativa' : 'Inativa' }}
            </span>
          </td>
          <td class="acoes">
            <button 
              pButton 
              type="button"
              [rounded]="true" 
              [text]="true" 
              icon="pi pi-eye" 
              pTooltip="Visualizar" 
              tooltipPosition="top"
              (click)="onVisualizarEmpresa(empresa)"
              class="p-button-sm p-button-secondary"
            ></button>
            <button 
              pButton 
              type="button"
              [rounded]="true" 
              [text]="true" 
              icon="pi pi-pencil" 
              pTooltip="Editar" 
              tooltipPosition="top"
              (click)="onEditarEmpresa(empresa)"
              class="p-button-sm p-button-info"
            ></button>
            <button 
              pButton 
              type="button"
              [rounded]="true" 
              [text]="true" 
              icon="pi pi-trash" 
              pTooltip="Excluir" 
              tooltipPosition="top"
              (click)="deletarEmpresa(empresa.id!)"
              class="p-button-sm p-button-danger"
            ></button>
          </td>
        </tr>
      </tbody>
    </table>

    <div *ngIf="!carregando() && !empresasFiltradas().length" class="empty-state">
      <div class="empty-icon">
        <i class="pi pi-building"></i>
      </div>
      <h3>Nenhuma empresa encontrada</h3>
      <p>Clique em "Consultar" para carregar as empresas ou "Nova Empresa" para adicionar uma.</p>
    </div>
  </div>
</div>
